function t(t,e,i){var s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3);var a="expires="+s.toUTCString();document.cookie=t+"="+e+"; "+a}function e(t){for(var e=t+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var a=i[s];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""}function i(t,e){var i=t.length;if(i){for(;i>e;)t[e++]=t[e];--t.length}}var s=function(){};s.prototype={init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},preload:function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},create:function(){this.stage.backgroundColor="#2c3e50",this.fontLoad=d.add.text(d.world.centerX,d.world.centerY," a ",{font:"200px",fill:"#ecf0f1"}),this.fontLoad.visible=!1,this.fontLoad.font="exo",this.state.start("Preload")}};var a={peter_river:"#3498db",belize_hole:"#2980b9",turquoise:"#1abc9c",green_sea:"#16a085",emerald:"#2ecc71",nephritis:"#27ae60",amethyst:"#9b59b6",wisteria:"#8e44ad",sun_flower:"#f1c40f",orange:"#f39c12",carrot:"#e67e22",pumpkin:"#d35400",alizarin:"#e74c3c",pomegranate:"#c0392b",concrete:"#95a5a6",asbestos:"#7f8c8d"},r=["peter_river","turquoise","emerald","amethyst","sun_flower","carrot","alizarin","concrete"],o=["belize_hole","green_sea","nephritis","wisteria","orange","pumpkin","pomegranate","asbestos"],n={0:{x:10,y:130},1:{x:105,y:130},2:{x:200,y:130},3:{x:10,y:225},4:{x:105,y:225},5:{x:200,y:225},6:{x:10,y:320},7:{x:105,y:320},8:{x:200,y:320}},h=function(){this.points=0,this.best=0,this.bar=null,this.timeBar=null,this.blocks=null,this.timeLeft=2500,this.timeTween=null};h.prototype={init:function(t){this.config=t;var i=e("ColorMatch_BestScore");""!=i&&(this.best=i),d.renderer.renderSession.roundPixels=!0},create:function(){this.score=d.add.text(d.world.width-25,25,"0 ",{font:"24px",fill:"#ecf0f1"}),this.score.font="exo",this.score.anchor.setTo(.5),this.bestScore=d.add.text(25,25,this.best+" ",{font:"24px",fill:"#ecf0f1"}),this.bestScore.font="exo",this.bestScore.anchor.setTo(.5),this.blocks=this.add.group(),this.spawnBlocks()},createBlock:function(t,e,i,s){t="0x"+t.substring(1);var a=d.add.graphics(0,0);a.beginFill(t),a.drawRect(0,0,90,90),a.endFill();var r=d.add.sprite(e,i,null);r.inputEnabled=!0,r.addChild(a),a=null,s?r.isPoint=!0:r.isPoint=!1,r.events.onInputDown.add(this.click,this),this.blocks.add(r),r=null},createBars:function(t){t="0x"+t.substring(1),this.bar=d.add.graphics(10,60),this.bar.beginFill(t),this.bar.drawRect(0,0,280,30),this.bar.endFill();var e=this.points<35?this.timeLeft-50*this.points:750;this.timeBar=d.add.graphics(10,95),this.timeBar.beginFill(15528177),this.timeBar.drawRect(0,0,280,10),this.timeBar.endFill(),timeBarMask=d.add.graphics(280,95),timeBarMask.beginFill(2899536),timeBarMask.drawRect(0,0,280,10),timeBarMask.endFill(),this.timeTween=d.add.tween(timeBarMask),this.timeTween.to({x:10},e,"Linear",!0),this.timeTween.onComplete.addOnce(function(){timeBarMask.kill(),this.end(),this.respawn()},this)},spawnBlocks:function(){var t=[0,1,2,3,4,5,6,7,8],e=Math.floor(9*Math.random()),s=this.points<20?r.slice():r.concat(o),h=s.length,l=Math.floor(Math.random()*h),d=a[s[l]];this.createBars(d),this.createBlock(d,n[t[e]].x,n[t[e]].y,!0),i(t,e),i(s,l);for(var c=this.points<=16?this.points:8,p=0;c>p;p++)e=Math.floor(Math.random()*(8-p)),l=Math.floor(Math.random()*(h-1)),d=a[s[l]],this.createBlock(d,n[t[e]].x,n[t[e]].y),i(t,e);t=null,s=null},click:function(t){t.isPoint?this.points++:this.end(),this.score.text=this.points.toString(),this.respawn()},end:function(){this.points>this.best&&(this.best=this.points,this.bestScore.text=this.best.toString(),t("ColorMatch_BestScore",this.best,7)),this.points=0,this.score.text="0"},respawn:function(){this.tweens.removeAll(),this.blocks.removeAll(),this.bar.kill(),this.timeBar.kill(),this.spawnBlocks()}};var l=function(){this.preloadBar=null,this.ready=!0};l.prototype={preload:function(){this.preloadBar=this.add.sprite(.5*d.width,.5*d.height,"preloader",0),this.preloadBar.anchor.set(.5,.5);var t=[],e=0;for(e;33>e;e++)t[e]=e;this.preloadBar.animations.add("loading",t,60,!0),this.preloadBar.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.ready&&this.state.start("Game")},onLoadComplete:function(){this.ready=!0}};var d=new Phaser.Game(300,420,Phaser.Canvas,"game_cont");d.state.add("Boot",s),d.state.add("Preload",l),d.state.add("Game",h),d.state.start("Boot");