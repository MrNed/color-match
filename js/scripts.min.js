function t(){var t=new Phaser.Game(300,420,Phaser.Canvas,"game_cont");t.state.add("Boot",a),t.state.add("Preload",P),t.state.add("Menu",C),t.state.add("Game",x),t.state.start("Boot")}function e(t,e,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var a="expires="+i.toUTCString();document.cookie=t+"="+e+"; "+a}function n(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""}function i(t,e){var n=t.length;if(n){for(;n>e;)t[e++]=t[e];--t.length}}var a=function(){this.init=function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},this.preload=function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},this.create=function(){this.stage.backgroundColor="#2c3e50",this.state.start("Preload")}},o={group_1:["0x3498db","0x1abc9c","0x2ecc71"],group_1_hard:["0x3498db","0x1abc9c","0x2ecc71","0x2980b9","0x16a085","0x27ae60"],group_2:["0xf1c40f","0xe67e22","0xe74c3c"],group_2_hard:["0xf1c40f","0xe67e22","0xe74c3c","0xf39c12","0xd35400","0xc0392b"]},r={0:{x:10,y:130},1:{x:105,y:130},2:{x:200,y:130},3:{x:10,y:225},4:{x:105,y:225},5:{x:200,y:225},6:{x:10,y:320},7:{x:105,y:320},8:{x:200,y:320}},s=null,d=0,l=0,c="",h="",u=null,f=null,p=2500,g=null,x=function(t){this.init=function(e){this.config=e;var i=n("ColorMatch_BestScore");""!=i&&(l=i),t.renderer.renderSession.roundPixels=!0},this.create=function(){c=this.add.bitmapText(this.world.width-10,25,"04font","0",28),c.anchor.setTo(1,.5),h=this.add.bitmapText(this.world.width-60,25,"04font",l,28),h.anchor.setTo(1,.5);var e=this.add.button(10,22,"sprites",function(){this.state.start("Menu",!0,!1,this.config)},this,"menu_active.png","menu.png","menu_active.png");e.anchor.set(0,.5),e.input.useHandCursor=!0,s=this.add.group(),b(t)}},m=function(t,e,n,i,a){var o=t.add.graphics(0,0);o.beginFill(e),o.drawRect(0,0,90,90),o.endFill();var r=t.add.sprite(n,i,null);r.inputEnabled=!0,r.addChild(o),o=null,a?r.isPoint=!0:r.isPoint=!1,r.events.onInputDown.add(function(e){M(e,t)}),s.add(r),r=null},v=function(t,e){u=t.add.graphics(10,60),u.beginFill(e),u.drawRect(0,0,280,30),u.endFill();var n=35>d?p-50*d:1e3;f=t.add.graphics(10,95),f.beginFill(15528177),f.drawRect(0,0,280,10),f.endFill(),timeBarMask=t.add.graphics(280,95),timeBarMask.beginFill(2899536),timeBarMask.drawRect(0,0,280,10),timeBarMask.endFill(),t.time.events.add(1,function(){g=t.add.tween(timeBarMask),g.to({x:10},n,"Linear",!0),g.onComplete.addOnce(function(){timeBarMask.kill(),y(),w(t)},this)},this)},b=function(t){var e=[0,1,2,3,4,5,6,7,8],n=Math.floor(9*Math.random()),a="group_"+(Math.floor(2*Math.random())+1),s=20>d?a:a+"_hard",l=o[s].slice(),c=20>d?3:6,h=Math.floor(Math.random()*c),u=l[h];v(t,u),m(t,u,r[e[n]].x,r[e[n]].y,!0),i(e,n),i(l,h);var f=7>=d?d:8,p=0;for(p=0;f>p;p++)n=Math.floor(Math.random()*(8-p)),h=Math.floor(Math.random()*(c-1)),u=l[h],m(t,u,r[e[n]].x,r[e[n]].y),i(e,n);e=null,l=null},M=function(t,e){t.isPoint?d++:y(),c.text=d.toString(),w(e)},w=function(t){t.tweens.removeAll(),s.removeAll(),u.kill(),f.kill(),b(t)},y=function(){d>l&&(l=d,h.text=l.toString(),e("ColorMatch_BestScore",l,7)),d=0,c.text="0"},_=["white","emerald","sun_flower","blue","alizarin"];titleIndex=0;var C=function(t){this.init=function(e){e||(e={}),this.config=e,t.renderer.renderSession.roundPixels=!0},this.create=function(){var t=this.add.sprite(this.world.centerX,100,"sprites","title_white.png");t.anchor.set(.5),this.time.events.add(1,function(){this.time.events.loop(5e3,function(){titleIndex++,5==titleIndex&&(titleIndex=0),t.frameName="title_"+_[titleIndex]+".png"},this)},this);var e=this.add.button(this.world.centerX,this.world.centerY,"sprites",function(){this.state.start("Game",!0,!1,this.config)},this,"play_active.png","play.png","play_active.png");e.anchor.set(.5),e.input.useHandCursor=!0}},k=null,B=!1,P=function(){this.preload=function(){k=this.add.sprite(this.world.centerX,this.world.centerY,"preloader",0),k.anchor.set(.5,.5);var t=[],e=0;for(e;33>e;e++)t[e]=e;k.animations.add("loading",t,60,!0),k.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.atlas("sprites","res/sprites.png","res/sprites.json"),this.load.bitmapFont("04font","res/04font.png","res/04font.fnt")},this.create=function(){k.cropEnabled=!1},this.update=function(){B&&this.state.start("Menu")},this.onLoadComplete=function(){B=!0}};"complete"===document.readyState||"interactive"===document.readyState?t():document.addEventListener("DOMContentLoaded",t,!1);