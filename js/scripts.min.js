var t={};t.Boot=function(){},t.Boot.prototype={init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},preload:function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},create:function(){this.stage.backgroundColor="#2c3e50",this.fontLoad=o.add.text(o.world.centerX,o.world.centerY," a ",{font:"200px",fill:"#ecf0f1"}),this.fontLoad.visible=!1,this.fontLoad.font="exo",this.state.start("Preload")}};var e={peter_river:"#3498db",belize_hole:"#2980b9",turquoise:"#1abc9c",green_sea:"#16a085",emerald:"#2ecc71",nephritis:"#27ae60",amethyst:"#9b59b6",wisteria:"#8e44ad",sun_flower:"#f1c40f",orange:"#f39c12",carrot:"#e67e22",pumpkin:"#d35400",alizarin:"#e74c3c",pomegranate:"#c0392b",concrete:"#95a5a6",asbestos:"#7f8c8d"},i=["peter_river","turquoise","emerald","amethyst","sun_flower","carrot","alizarin","concrete"],a=["belize_hole","green_sea","nephritis","wisteria","orange","pumpkin","pomegranate","asbestos"],s={0:{x:10,y:130},1:{x:105,y:130},2:{x:200,y:130},3:{x:10,y:225},4:{x:105,y:225},5:{x:200,y:225},6:{x:10,y:320},7:{x:105,y:320},8:{x:200,y:320}};t.Game=function(t){this.points=0,this.best=0,this.bar=null,this.timeBar=null,this.blocks=null,this.timeLeft=2500,this.timeTween=null},t.Game.prototype={init:function(t){this.config=t,o.renderer.renderSession.roundPixels=!0},create:function(){var t=this;t.score=o.add.text(o.world.width-25,25,"0 ",{font:"24px",fill:"#ecf0f1"}),t.score.font="exo",t.score.anchor.setTo(.5),t.bestScore=o.add.text(25,25,"0 ",{font:"24px",fill:"#ecf0f1"}),t.bestScore.font="exo",t.bestScore.anchor.setTo(.5),this.blocks=this.add.group(),this.spawnBlocks()},createBlock:function(t,e,i,a){var s=o.add.bitmapData(90,90);s.ctx.rect(0,0,90,90),s.ctx.fillStyle=t,s.ctx.fill();var r=o.add.sprite(e,i,s);r.inputEnabled=!0,a?r.isPoint=!0:r.isPoint=!1,r.events.onInputDown.add(this.click,this),this.blocks.add(r)},createBars:function(t){t="0x"+t.substring(1),this.bar=o.add.graphics(10,60),this.bar.beginFill(t),this.bar.drawRect(0,0,280,30),this.bar.endFill();var e=this.points<35?this.timeLeft-50*this.points:750;this.timeBar=o.add.graphics(10,95),this.timeBar.beginFill(15528177),this.timeBar.drawRect(0,0,280,10),this.timeBar.endFill(),timeBarMask=o.add.graphics(280,95),timeBarMask.beginFill(2899536),timeBarMask.drawRect(0,0,280,10),timeBarMask.endFill(),this.timeTween=o.add.tween(timeBarMask),this.timeTween.to({x:10},e,"Linear",!0),this.timeTween.onComplete.addOnce(function(){timeBarMask.kill(),this.points=0,this.respawn()},this)},spawnBlocks:function(){var t=[0,1,2,3,4,5,6,7,8],o=Math.floor(Math.random()*t.length),r=this.points<20?i.slice():i.concat(a),n=r.length,l=Math.floor(Math.random()*n),h=e[r[l]];this.createBars(h),this.createBlock(h,s[t[o]].x,s[t[o]].y,!0),t.splice(o,1),r.splice(l,1);for(var c=this.points<=16?this.points/2:8,d=0;c>d;d++)o=Math.floor(Math.random()*t.length),l=Math.floor(Math.random()*r.length),h=e[r[l]],this.createBlock(h,s[t[o]].x,s[t[o]].y),t.splice(o,1)},click:function(t){t.isPoint?this.points++:this.points=0,this.points>this.best&&(this.best=this.points,this.bestScore.text=this.best.toString()),this.score.text=this.points.toString(),this.respawn()},respawn:function(){this.tweens.removeAll(),this.blocks.forEach(function(t,e){t.kill()}),this.bar.kill(),this.timeBar.kill(),this.spawnBlocks()}},t.Preload=function(){this.preloadBar=null,this.ready=!0},t.Preload.prototype={preload:function(){this.preloadBar=this.add.sprite(.5*o.width,.5*o.height,"preloader",0),this.preloadBar.anchor.set(.5,.5);var t=[],e=0;for(e;33>e;e++)t[e]=e;this.preloadBar.animations.add("loading",t,60,!0),this.preloadBar.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.ready&&this.state.start("Game")},onLoadComplete:function(){this.ready=!0}};var o=new Phaser.Game(300,420,Phaser.Canvas,"game_cont");o.state.add("Boot",t.Boot),o.state.add("Preload",t.Preload),o.state.add("Game",t.Game),o.state.start("Boot");