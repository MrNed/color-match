var Bar=function(t,e,a){if(a){s=t.add.graphics(10,95),s.beginFill(15528177),s.drawRect(0,0,280,10),s.endFill(),buttonMask=t.add.graphics(280,95),buttonMask.beginFill(2899536),buttonMask.drawRect(0,0,280,10),buttonMask.endFill();var i=t.add.tween(buttonMask);i.to({x:10},a,"Linear",!0),i.onComplete.addOnce(function(){},this)}else{e="0x"+e.substring(1);var s=t.add.graphics(10,60);s.beginFill(e),s.drawRect(0,0,280,30),s.endFill()}};Bar.prototype=Object.create(Phaser.Sprite.prototype),Bar.prototype.constructor=Bar;var Block=function(t,e,a,i,s,o){a?this.point=!0:this.point=!1;var n=t.add.bitmapData(90,90);n.ctx.rect(0,0,90,90),n.ctx.fillStyle=e,n.ctx.fill(),Phaser.Sprite.call(this,t,i,s,n),this.inputEnabled=!0,o.add(this)};Block.prototype=Object.create(Phaser.Sprite.prototype),Block.prototype.constructor=Block;var BasicGame={};BasicGame.Boot=function(){},BasicGame.Boot.prototype={init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},preload:function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},create:function(){this.stage.backgroundColor="#2c3e50",this.fontLoad=game.add.text(game.world.centerX,game.world.centerY," a ",{font:"200px",fill:"#ecf0f1"}),this.fontLoad.visible=!1,this.fontLoad.font="exo",this.state.start("Preload")}},BasicGame.Game=function(t){this.points=0,this.best=0,this.bar=null,this.timeBar=null,this.blocks=null,this.timeLeft=2500,this.timeTween=null,this.colors={peter_river:"#3498db",belize_hole:"#2980b9",turquoise:"#1abc9c",green_sea:"#16a085",emerald:"#2ecc71",nephritis:"#27ae60",amethyst:"#9b59b6",wisteria:"#8e44ad",sun_flower:"#f1c40f",orange:"#f39c12",carrot:"#e67e22",pumpkin:"#d35400",alizarin:"#e74c3c",pomegranate:"#c0392b",concrete:"#95a5a6",asbestos:"#7f8c8d"},this.colorsTierOne=["peter_river","turquoise","emerald","amethyst","sun_flower","carrot","alizarin","concrete"],this.colorsTierTwo=["belize_hole","green_sea","nephritis","wisteria","orange","pumpkin","pomegranate","asbestos"],this.pos={0:{x:10,y:130},1:{x:105,y:130},2:{x:200,y:130},3:{x:10,y:225},4:{x:105,y:225},5:{x:200,y:225},6:{x:10,y:320},7:{x:105,y:320},8:{x:200,y:320}}},BasicGame.Game.prototype={init:function(t){this.config=t,game.renderer.renderSession.roundPixels=!0},create:function(){var t=this;t.score=game.add.text(game.world.width-25,25,"0 ",{font:"24px",fill:"#ecf0f1"}),t.score.font="exo",t.score.anchor.setTo(.5),t.bestScore=game.add.text(25,25,"0 ",{font:"24px",fill:"#ecf0f1"}),t.bestScore.font="exo",t.bestScore.anchor.setTo(.5),this.blocks=this.add.group(),this.spawnBlocks()},spawnBlocks:function(){var t=[0,1,2,3,4,5,6,7,8],e=Math.floor(Math.random()*t.length),a=this.points<20?this.colorsTierOne.slice():this.colorsTierOne.concat(this.colorsTierTwo),i=a.length,s=Math.floor(Math.random()*i),o=this.colors[a[s]];this.bar=new Bar(game,o);var n=this.points<35?this.timeLeft-50*this.points:750,r=game.add.graphics(10,95);r.beginFill(15528177),r.drawRect(0,0,280,10),r.endFill(),timeBarMask=game.add.graphics(280,95),timeBarMask.beginFill(2899536),timeBarMask.drawRect(0,0,280,10),timeBarMask.endFill(),this.timeTween=game.add.tween(timeBarMask),this.timeTween.to({x:10},n,"Linear",!0),this.timeTween.onComplete.addOnce(function(){this.points=0,this.respawn()},this);var c=new Block(game,o,!0,this.pos[t[e]].x,this.pos[t[e]].y,this.blocks,self.click,self);c.events.onInputDown.add(this.click,this),t.splice(e,1),a.splice(s,1);for(var l=this.points<=16?this.points/2:8,h=0;l>h;h++)e=Math.floor(Math.random()*t.length),s=Math.floor(Math.random()*a.length),o=this.colors[a[s]],c=new Block(game,o,!1,this.pos[t[e]].x,this.pos[t[e]].y,this.blocks),c.events.onInputDown.add(this.click,this),t.splice(e,1)},click:function(t){t.point?this.points++:this.points=0,this.points>this.best&&(this.best=this.points,this.bestScore.text=this.best.toString()),this.score.text=this.points.toString(),this.respawn()},respawn:function(){this.tweens.removeAll(),this.blocks.forEach(function(t,e){t.kill()}),this.bar.kill(),this.spawnBlocks()}},BasicGame.Menu=function(){},BasicGame.Menu.prototype={init:function(t){t||(t={}),this.config=t},create:function(){this.startClick()},update:function(){},startClick:function(){this.state.start("Game",!0,!1,this.config)}},BasicGame.Preload=function(){this.preloadBar=null,this.ready=!0},BasicGame.Preload.prototype={preload:function(){this.preloadBar=this.add.sprite(.5*game.width,.5*game.height,"preloader",0),this.preloadBar.anchor.set(.5,.5);var t=[],e=0;for(e;33>e;e++)t[e]=e;this.preloadBar.animations.add("loading",t,60,!0),this.preloadBar.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.ready&&this.state.start("Menu")},onLoadComplete:function(){this.ready=!0}};var game=new Phaser.Game(300,420,Phaser.Canvas,"game_cont");game.state.add("Boot",BasicGame.Boot),game.state.add("Preload",BasicGame.Preload),game.state.add("Menu",BasicGame.Menu),game.state.add("Game",BasicGame.Game),game.state.start("Boot");